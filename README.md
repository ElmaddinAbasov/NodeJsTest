# Описание проекта

Нужно разработать сервис работы с пользователем. Модель пользователя должна содержать :

-  ФИО
-  Дату Рождения
-  Email
-  Пароль
-  Роль либо админ либо user
-  Статус пользователя активный или нет

  Админ в нашей системе реализован через объект admin заполняется в конструкторе класса databaseHandler и сразу же записывается в базу данных

Должнен быть реализован следующий функционал :

  -  Регистрация пользователя
  -  Авторизация пользователя
  -  Получение пользователя по ID(может получить админ либо пользователь сам себя)
  -  Получение списка пользователей - только админ
  -  Блокировка пользователя либо админ либо пользователь сам себя
    
# Инструменты и Технологии которые использовались

- JavaScript
- Node JS
- Postgres (PG модуль)

# Как запускать программу

Перед запуском нужно открыть файл server.mjs, в нем найти приватное поле #dbPassword - и записать туда пароль который вы используете на своей системе, когда используете базу данных  Postgres. 
После того как вы установили необходимы пароль, в терминале нужно запустить команду node server.mjs, после этого октрыть браузер и вбить URL - https://localhost:8080/reg.html? который выведет вам форму для регистрации.

Используем порт 8080

# Описание классов

У нас есть три класса :

- класс databaseHandler, работает с базой данных  Postgres
- класс Queries хранит SQL запросы
- класс server обеспечивает работу сервера и обрабатывает запросы

## Описание работы класса databaseHandler

Класс databaseHandler имеет следующие поля : 

-  #client - используем для подлкючения и работы с базой данных и таблицей
-  #sqlQueries - используем для работы с SQL запросами
-  #tableName - задаем имя таблицы, которая будет содержать всю информацию. В нашем примере имя таблицы users_info
-  #dbName - задает имя базы данных
-  #admin - объект который хранит информацию об админе

Методы класса databaseHandler :

- Конструктор инциализирует информацию об администраторе (имя, фамилию, почта, пароль и так далее)
- метод buildClient - иницифлизирует поля объекта #client. Указываем к какой базе данных хотим подключиться.(имя базы данных, пароль и так далее)
- async close закрывает соединение с базой данных
- checkIfDatabaseExsist() - метод проверяет существует ли нужная нам база данных и если нет, то мы создаем новую
- checkIfTableExsist() -  метод проверяет существует ли заданная таблица в базе данных, если нет то создаем её
- runParameterisedQuery(query) - метод выполняет SQL запрос с параметрами.

## Описание работы класса server

Класс server обрабатывает запросы клиента и отправлет ответы на запросы.

Как происходит работа ?

Сначала мы подключаемся к базе данных postgres, после этого создаем базу данных users_db, в ней создаем таблицу users_info с полями (last_name, first_name, paternal_name, email, passwd, role, status)

Методы класса server :

- constructor - инифиализирует поля класса
- preparation проводит подготовку к работе, подключается к базе данных, создает таблицу
- serverReadFile(res, path) - считывает HTML файлы и отправляет их в качестве ответа клиенту.
- handleGetMethod(req, res) - обрабатывает GET запросы от клиента
- handlePostMethod(req, res) - обрабатывает POST ответы
- #serverRun(req, res) - сервер принимает и обрабатывает POST GET запросы
- writeToATable - записывает данные в таблицу


# Описание результата работы

## Регистрация 

Для начала работы нужно запустить сервер командой node server.mjs и перейти по запросу https://localhost:8080/reg.html. Перед нами выйдет форма для регистрации пользователя

Еще до регистрации пользователя в базе данных уже записан администратор. Взглянем на нащу базу данных. В терминале запустим postgres. Подключимся командой \с users_db. Подключимся к таблице \dt users_info;

Вот как выглядит наша таблица

<img width="1673" height="521" alt="Screenshot from 2026-01-05 14-59-53" src="https://github.com/user-attachments/assets/54e51561-6d4a-4c52-90d4-0390e76f8e04" />

Как видим в базе данных уже хранится вся информация об администраторе.

Далее зарегестрируемся в системе в качестве Сергея Сервегевича Иванова(Sergey Ivanovich Ivanov) ivan@gmail.com. Если все прошло успешно, то новая запись появилтся в базе данных
Форма регистрации.


<img width="1857" height="842" alt="Screenshot from 2026-01-05 15-04-01" src="https://github.com/user-attachments/assets/53bcca5b-3319-4f52-b3ce-ceb70de2314f" />

Посмотрим на базу данных. Новый пользователь появился в базе данных.

<img width="1896" height="304" alt="Screenshot from 2026-01-05 15-05-28" src="https://github.com/user-attachments/assets/76f9f83f-3939-4a95-8e76-688260eef823" />

Попробуем зарегестрировать пользователся Петр Петрович Иванов (Ivanov Pert Petrovich) 

<img width="1896" height="304" alt="Screenshot from 2026-01-05 15-08-53" src="https://github.com/user-attachments/assets/350dd5f6-b4e6-4692-8865-46dc74a0ebbf" />

Как видим теперь у нас три пользователя в системе. 

Идем дальше 

# Авторизация

Попробуем авторизоваться в системе в качестве администратора. Для этого перейдем по адресу https://localhost:8080/auth.html. Перед нами появится форма для авторизации, для нее необходимо ввести почту и пароль.


<img width="1896" height="304" alt="Screenshot from 2026-01-05 15-11-00" src="https://github.com/user-attachments/assets/55adb068-dfb6-4a0a-95a6-796d969a17e6" />

Введем почту для администратора __admin@__ и пароль __admin__. После успешной авторизации у нас появится меню 

<img width="1896" height="304" alt="Screenshot from 2026-01-05 15-16-00" src="https://github.com/user-attachments/assets/3d68f08f-3c37-464f-b161-3ea3fdf98771" />

## Меню 

Попробуем получить список всех пользователей в системе, это доступно только администратору. Выберем опцию get_list_of_users 


<img width="1896" height="545" alt="Screenshot from 2026-01-05 15-16-58" src="https://github.com/user-attachments/assets/7e9e092a-28a0-4a80-9d71-7004e5ea1d35" />


И получим список 


<img width="1896" height="545" alt="Screenshot from 2026-01-05 15-18-09" src="https://github.com/user-attachments/assets/edfc8cc5-0e8b-4e04-ba0d-acc29a86a812" />


### Попробуем получить пользователя по ID

Получим информацию о пользователе Сергей Иванов с ID - 2


<img width="1896" height="545" alt="Screenshot from 2026-01-05 15-20-41" src="https://github.com/user-attachments/assets/93715c6d-118c-42d0-8664-708e2e0ebe7d" />

Как видим удалось получить всю информацию о данном пользователе.

Вернемся обратно в меню нажав стрелочку обратно

### Теперь попробуем заблокировать пользователя

Заблокируем Сергея Иванова с ID - 2. В результате в базе данных статус смениться с active на inactive

В результате получем на веб странице 


<img width="1896" height="545" alt="Screenshot from 2026-01-05 15-23-37" src="https://github.com/user-attachments/assets/cc7e12e7-6c8e-4f27-ad06-048e05eeb28c" />


Посмотрим что стало с базой данных

<img width="1890" height="327" alt="Screenshot from 2026-01-05 15-24-40" src="https://github.com/user-attachments/assets/c9cea58c-9c5a-4afe-b378-7c818cb9c176" />

Как видим статус пользователся изменился
